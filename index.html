<form id="dataForm">
  <input type="text" name="no" placeholder="No">
  <input type="text" name="barcode" placeholder="Barcode">
  <input type="text" name="prodname" placeholder="Nama Produk">
  <input type="text" name="nie" placeholder="NIE">
  <input type="date" name="periode" placeholder="periode">
  <input type="date" name="Expired" placeholder="Expired">
  <input type="text" name="keterangan" placeholder="Keterangan">
  <button type="submit">Submit</button>
</form>

<script>
document.getElementById('dataForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const formData = new FormData(this);
  const jsonData = {};

  formData.forEach((value, key) => {
    // Format tanggal untuk Google Sheets (MM/dd/yyyy)
    if (key === 'periode' || key === 'Expired') {
      const date = new Date(value);
      jsonData[key] = date.toLocaleDateString('en-US');
    } else {
      jsonData[key] = value;
    }
  });

  fetch('https://script.google.com/macros/s/AKfycbyaX0csiUg3IsCpXo-dk_g_kYKzWZv70CLquWpeLDeL4s66Ov7gEi2gnxgHnPPI9U4j/exec', {
    method: 'POST',
    body: JSON.stringify(jsonData),
    headers: {
      'Content-Type': 'application/json'
    }
  })
     .then(response => {
      alert("Berhasil disimpan!");
      form.reset();
    })
    .catch(error => alert("Gagal mengirim data!"));
  });
</script>
