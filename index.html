<form id="dataForm">
  <input type="text" name="no" placeholder="No">
  <input type="text" name="barcode" placeholder="Barcode">
  <input type="text" name="prodname" placeholder="Nama Produk">
  <input type="text" name="nie" placeholder="NIE">
  <input type="date" name="periode" placeholder="periode">
  <input type="date" name="Expired" placeholder="Expired">
  <input type="text" name="keterangan" placeholder="Keterangan">
  <button type="submit">Submit</button>
</form>

<script>
document.getElementById('dataForm').addEventListener('submit', function(e) {
  e.preventDefault();
  const formData = new FormData(this);
  const jsonData = {};

  formData.forEach((value, key) => {
    // Format tanggal untuk Google Sheets (yyyy-MM-dd)
    if (key === 'periode' || key === 'Expired') {
      const date = new Date(value);
      const formattedDate = date.toISOString().split('T')[0];
      jsonData[key] = formattedDate;
    } else {
      jsonData[key] = value;
    }
  });

  // Ganti URL ini dengan URL Web App Anda yang baru
  fetch('https://script.google.com/macros/s/AKfycbwsopL3ZlHCj5gOWr_me_1gfpJy8FtmpTTBN3u23imRNfSaALN-wgyW7v2ihpUGOw1PsA/exec', {
    method: 'POST',
    body: JSON.stringify(jsonData),
    headers: {
      'Content-Type': 'application/json'
    }
  })
  .then(response => response.json())
  .then(data => {
    if (data.status === 'success') {
      alert('Data berhasil disimpan!');
      document.getElementById('dataForm').reset();
    } else {
      alert('Error: ' + data.message);
    }
  })
  .catch(error => {
    console.error('Error:', error);
    alert('Terjadi kesalahan saat mengirim data');
  });
});
</script>
