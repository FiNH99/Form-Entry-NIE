<form id="form-nie">
  <input type="text" name="barcode" placeholder="Barcode" required><br>
  <input type="text" name="prodname" placeholder="Product Name" required><br>
  <input type="text" name="nie" placeholder="NIE" required><br>
  <input type="text" name="masaberlaku" placeholder="Masa Berlaku (DD/MM/YYYY)" required><br>
  <input type="text" name="expired" placeholder="Expired Produk (DD/MM/YYYY)" required><br>
  <input type="text" name="keterangan" placeholder="Keterangan"><br>
  <button type="submit">Kirim</button>
</form>

<script>
  const scriptURL = 'https://script.google.com/macros/s/AKfycbzr0Vs_iJidfGLFVC0KRJ7CC-9O2CzXioARZve9rb3bHbj6CmeV7De-p2VeOdnYJLRl/exec';
  const form = document.getElementById('form-nie');

  form.addEventListener('submit', e => {
    e.preventDefault();
    const formData = new FormData(form);
    const data = Object.fromEntries(formData.entries());

    fetch(scriptURL, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json'
      },
      body: JSON.stringify(data)
    })
    .then(response => response.text())
    .then(result => {
      if (result.toLowerCase().includes("success")) {
        alert("✅ Data berhasil disimpan!");
        form.reset();
      } else {
        alert("⚠️ Terjadi kesalahan: " + result);
      }
    })
    .catch(error => {
      console.error('Error!', error.message);
      alert("❌ Gagal mengirim data: " + error.message);
    });
  });
</script>
